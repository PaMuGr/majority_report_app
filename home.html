<!DOCTYPE html>
<link rel="stylesheet" href="/node_modules/@shoelace-style/shoelace/dist/themes/light.css" />
<script type="module" src="/node_modules/@shoelace-style/shoelace/dist/shoelace.js"></script>

<html>
<head>
    <meta charset="UTF-8">
    <title>Majority Report</title>
    <link rel="stylesheet" href="css/index.css">

    <link rel="stylesheet" href="css/profile.css">
    <!-- Add Firebase SDK -->
    <script type="module">
        // Import Firebase
        import { initializeApp } from "https://www.gstatic.com/firebasejs/10.12.0/firebase-app.js";
        import { getAuth, onAuthStateChanged } from "https://www.gstatic.com/firebasejs/10.12.0/firebase-auth.js";

        // Your Firebase configuration
        const firebaseConfig = {
            apiKey: "AIzaSyCyOgBBXIo5C-LtsbrdxZepRZoWeF7r17M",
            authDomain: "majority-report-33739.firebaseapp.com",
            projectId: "majority-report-33739",
            storageBucket: "majority-report-33739.appspot.com",
            messagingSenderId: "96713972972",
            appId: "1:96713972972:web:ecdba62f0a3c29d01259c9",
            measurementId: "G-Z379S3VVY9"
        };

        // Initialize Firebase
        const app = initializeApp(firebaseConfig);
        const auth = getAuth(app);

        
        // Check auth state when page loads
        document.addEventListener("DOMContentLoaded", () => {
            onAuthStateChanged(auth, (user) => {
                if (user) {
                    // User is signed in
                    const displayName = user.displayName || "User";
                    
                    // Update all placeholders with the username
                    document.querySelectorAll('p, h2').forEach(element => {
                        if (element.textContent.includes('@user') || element.textContent.includes('@USERNAME')) {
                            element.textContent = element.textContent.replace('@user', displayName)
                                                                     .replace('@USERNAME', displayName.toUpperCase());
                        }
                    });

                    // Update profile name
                    document.getElementById('profile-name').textContent = displayName;
                } else {
                    // User is not signed in, redirect to login
                    window.location.href = "index.html";
                }
            });
        });
    </script>
</head>

<body>
    <div class="page-container">
    <nav>    
        <ul class="navigator">
            <li><a href="home.html" ><img src="graphics/home-icon.png"  height="20"  ></a></li>
            <li class="align-right">
                <a> <img src="graphics/user.png" height="20"> </a>
                <ul class="dropdown">
                    <li><a href="index.html">Log out</a></li>
                </ul>
            </li>
            <li><a href="leaderboard.html"><img src="graphics/bp.png" height="20"></a></li>
            <li><a href="editor.html"><img src="graphics/edit.png" height="20"></a></li>
        </ul>
    </nav>
    <main>
    <br><br><br><br>
    <div class="fila">
        <!-- BLOC 1 -->
        <div class="izquierda">
            <div style="text-align: center; margin-bottom: 10px;">
                <h1> Majority Report</h1>
            </div>

            <div style="text-align: center; margin-bottom: 25px;">
                <p>Welcome back @user!</p>
            </div>
            
            <div>
                <a href="prediction_scroll.html">
                    <button class="go_button">
                        <h3>Answer today's question!</h3>
                    </button>
                </a>
            </div>

            <div style="text-align: center; font-size: smaller;">
                <a href="editor.html">
                    <p>Or write one yourself!</p>
                </a>
            </div>
        </div>
        
        <!--
        <div class="box">
            <h2>STATS:</h2>
            <h2 style="text-align: center;">@USERNAME</h2><br><br>
            <ul>
                <div class="shade_box"><li>Level:</li></div>
                <br>
                <div class="shade_box"><li>Ratio:</li></div>
                <br>
                <div class="shade_box"><li>Global Rank:</li></div>
            </ul>
        </div>-->
        <br>



    </head>
    <body>

    <div class="profile-block">
        <div class="profile-name" id="profile-name">@user</div>

        <div class="progress-label" id="progress-text">Experience: 0%</div>
        <div class="progress-container">
        <div class="progress-bar" id="progress-bar"></div>
        </div>

        <div class="profile-stats">
        <div class="stat-item">
            <span class="label">Level</span>
            <span class="value" id="level">1</span>
        </div>
        <div class="stat-item">
            <span class="label">Ratio</span>
            <span class="value">0</span>
        </div>
        <div class="stat-item">
            <span class="label">Global Ranking</span>
            <span class="value">#1</span>
        </div>
        </div>
    </div>
    </main>

    <script>
        let level = 1;
        let progress = 0;
        const progressBar = document.getElementById('progress-bar');
        const progressText = document.getElementById('progress-text');
        const levelText = document.getElementById('level');

        function increaseProgress() {
        if (progress < 100) {
            updateBar();
        } else {
            // Añadir clase de brillo
            progressBar.classList.add('glow');

            setTimeout(() => {
            // Subir de nivel y reiniciar
            level++;
            levelText.textContent = level;
            progress = 0;
            updateBar();
            progressBar.classList.remove('glow');
            }, 1500); // Duración del brillo
        }
        }

        function updateBar() {
        progressBar.style.width = progress + '%';
        progressText.textContent = 'Experience: ' + progress + '%';
        }

        // Simula el aumento de experiencia cada 100ms
        setInterval(increaseProgress, 100);
    </script>
  </div>

    <footer class="site-footer">
        <div class="authors-inline">
        <span><a href="mailto:marlon.folch@estudiantat.upc.edu">Marlon Folch</a></span>
        <span><a href="mailto:pau.muras@estudiantat.upc.edu">Pau Muras</a></span>
        <span><a href="mailto:marcel.grau.martin@estudiantat.upc.edu">Marcel Grau</a></span>
        <span><a href="mailto:joemacbcn@gmail.com">Joe Mac Manus</a></span>
        </div>
    </footer>
  </div>
</body>
</html>